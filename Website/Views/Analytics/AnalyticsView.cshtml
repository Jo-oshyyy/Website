@{ ViewBag.Title = "Analytics"; }

<link href="~/Content/AnalyticsStyles.css" rel="stylesheet" />

<div class="analytics-container">
    <h2>Analytics</h2>

    <div class="tab-container">
        <div class="tab-headers">
            <button class="tab-header active" data-tab="demographics">
                <span class="tab-icon">👥</span>
                Demographics
            </button>
            <button class="tab-header" data-tab="engagement">
                <span class="tab-icon">📊</span>
                Engagement
            </button>
            <button class="tab-header" data-tab="performance">
                <span class="tab-icon">⚡</span>
                Performance
            </button>
        </div>

        <div class="tab-content-container">
            <!-- DEMOGRAPHICS TAB -->
            <div class="tab-content active" id="demographics">
                <div class="content-header">
                    <h3>Demographics Overview</h3>
                    <p>Student demographic information and statistics</p>
                </div>

                <!-- Filters Section -->
                <div class="filters-section">
                    <div class="filter-group">
                        <label for="schoolFilter">School Name:</label>
                        <select id="schoolFilter" class="filter-select">
                            <option value="">All Schools</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label for="barangayFilter">Barangay:</label>
                        <select id="barangayFilter" class="filter-select">
                            <option value="">All Barangays</option>
                        </select>
                    </div>
                    <button id="resetFilters" class="btn-reset">Reset Filters</button>
                </div>

                <!-- Interactive Table -->
                <div class="table-section">
                    <div class="table-controls">
                        <input type="text" id="tableSearch" placeholder="Search schools..." class="search-input">
                        <button id="exportTable" class="btn-export">Export to CSV</button>
                    </div>
                    <div class="table-wrapper">
                        <table id="demographicsTable" class="data-table">
                            <thead>
                                <tr>
                                    <th data-sort="schoolName">School Name <span class="sort-icon">⬍</span></th>
                                    <th data-sort="barangay">Barangay <span class="sort-icon">⬍</span></th>
                                    <th data-sort="studentCount">Student Count <span class="sort-icon">⬍</span></th>
                                    <th data-sort="percentage">% of Total <span class="sort-icon">⬍</span></th>
                                </tr>
                            </thead>
                            <tbody id="tableBody">
                                <!-- Populated by JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Charts Row -->
                <div class="charts-row">
                    <div class="chart-container">
                        <h4>Age Distribution</h4>
                        <canvas id="ageBoxPlot"></canvas>
                        <div class="chart-stats" id="ageStats"></div>
                    </div>
                    <div class="chart-container">
                        <h4>Gender Distribution</h4>
                        <canvas id="genderDonut"></canvas>
                        <div class="chart-stats" id="genderStats"></div>
                    </div>
                </div>
            </div>

            <!-- ENGAGEMENT TAB -->
            <div class="tab-content" id="engagement">
                <div class="content-header">
                    <h3>Engagement Analysis</h3>
                    <p>Track student interaction and engagement patterns</p>
                </div>

                <div class="charts-grid">
                    <div class="chart-container full-width">
                        <h4>Current Streak Distribution</h4>
                        <canvas id="currentStreakHistogram"></canvas>
                        <div class="chart-stats" id="streakStats"></div>
                    </div>

                    <div class="chart-container">
                        <h4>Longest Streak Analysis</h4>
                        <canvas id="longestStreakChart"></canvas>
                        <div class="chart-stats" id="longestStreakStats"></div>
                    </div>

                    <div class="chart-container">
                        <h4>Active vs Inactive Students</h4>
                        <canvas id="activeDonut"></canvas>
                        <div class="chart-stats" id="activeStats"></div>
                    </div>

                    <div class="chart-container full-width">
                        <h4>Login Frequency Over Time</h4>
                        <canvas id="loginFrequencyLine"></canvas>
                        <div class="chart-stats" id="loginStats"></div>
                    </div>
                </div>
            </div>

            <!-- PERFORMANCE TAB -->
            <div class="tab-content" id="performance">
                <div class="content-header">
                    <h3>Performance Indicators</h3>
                    <p>Student learning progress and achievement metrics</p>
                </div>

                <div class="charts-grid">
                    <div class="chart-container full-width">
                        <h4>Ability Growth Analysis</h4>
                        <canvas id="abilityGrowthArea"></canvas>
                        <div class="chart-stats" id="abilityStats"></div>
                    </div>

                    <div class="chart-container full-width">
                        <h4>XP Distribution</h4>
                        <canvas id="xpHistogram"></canvas>
                        <div class="chart-stats" id="xpStats"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Include Chart.js from CDN -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.1/chart.umd.min.js"></script>
<script src="~/Scripts/AnalyticsScript.js"></script>